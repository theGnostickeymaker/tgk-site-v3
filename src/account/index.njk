---
layout: base.njk
title: "Account"
description: "Manage your TGK profile, password, and membership subscription."
glyph: "ðŸœ‚"
glyphRow: ["ðŸœ‚","â˜¥","ðŸœ‚"]
bodyClass: "lightgold requires-auth"
permalink: "/account/index.html"

breadcrumbs:
  - { title: "The Gnostic Key", url: "/" }
  - { title: "Dashboard", url: "/dashboard/" }
  - { title: "Account" }
---

{% block head %}
  {% set socialImage = "/tgk-assets/images/share/system/account-settings.jpg" %}
  {% include "partials/head-meta.njk" %}
  {% set headline = "Account â€” The Gnostic Key" %}
  {% include "partials/jsonld-collection.njk" %}
{% endblock %}

#<body>
<main class="main-content page-account">
  <section class="content-container" id="page-account">

    <h2 class="section-heading">Your Account</h2>
    <p class="muted small">Manage your profile, password, and membership tier.</p>

    <!-- âœ¦ Membership -->
    <h3 class="section-heading">Membership Tier</h3>
    <div class="tier-display">
      <p id="tier">Checking accessâ€¦</p>
      <span id="tier-badge" class="tier-badge tier-free">Free</span>
    </div>

    <div class="btn-wrap">
      <button id="manage" class="btn outline">Manage Subscription</button>
    </div>
    <p class="small">Manage your billing, upgrade, or cancel anytime via Stripeâ€™s secure portal.</p>

    <!-- âœ¦ Profile -->
    <h3 class="section-heading">Profile Information</h3>
    <form id="profile-form" class="form-block">
      <label for="profile-name">Display Name</label>
      <input type="text" id="profile-name" placeholder="Your name" />

      <label for="profile-email">Email</label>
      <input type="email" id="profile-email" placeholder="Your email" disabled />

      <div class="btn-wrap">
        <button type="submit" class="btn outline">Save Changes</button>
        <span id="profile-status" class="small muted"></span>
      </div>
    </form>

    <!-- âœ¦ Password Reset -->
    <h3 class="section-heading">Password Reset</h3>
    <p>Need to change your password? You can send yourself a reset link here:</p>
    <button id="password-reset" class="btn outline">Send Reset Email</button>
    <p class="small">Or use the <a href="/password-reset/">dedicated reset page</a>.</p>

    <!-- âœ¦ Logout -->
    <h3 class="section-heading">Sign Out</h3>
    <p class="small">You can securely sign out of your TGK account below.</p>
    <button id="logout-btn" class="btn outline">Sign Out</button>

  </section>

  <div class="gnostic-divider">
    <span class="divider-symbol pillar-glyph spin glow" aria-hidden="true">{{ glyph or pillarGlyph }}</span>
  </div>
</main>

<!-- ðŸœ‚ Account Page Logic -->
<script type="module" src="/js/account.js?v={{ bust }}"></script>
<script type="module">
  import { loadDashboardHeader, pageSignout, updateTierUI } from "/js/tgk-user.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

  const auth = getAuth();

  document.addEventListener("DOMContentLoaded", () => {
    // Show cached tier immediately (no visitor flash if already known)
    const cached = localStorage.getItem("tgk-tier");
    if (cached) updateTierUI(cached);

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        await loadDashboardHeader(user);
        const btn = document.getElementById("logout-btn");
        if (btn) btn.addEventListener("click", pageSignout);
      } else {
        updateTierUI("visitor");
        window.__TGK_GATE__?.saveReturnUrl?.();
        if (!location.pathname.includes("/signin")) window.location.replace("/signin/");
      }
    });
  });
</script>

</body>
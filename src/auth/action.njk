---
layout: base.njk
title: "Account Action"
description: "Handling account verification and secure account recovery."
glyph: "☥"
glyphRow: ["☥", "✶", "☥"]
bodyClass: "lightgold"
permalink: "/auth/action/index.html"

breadcrumbs:
  - { title: "The Gnostic Key", url: "/" }
  - { title: "Membership", url: "/membership/" }
  - { title: "Account Action" }
---
<main class="main-content">
  <section class="content-container">
    <div class="auth-glyph-wrap">
      <div class="auth-glyph glow">✶</div>
    </div>

    <section class="section-block auth-form">
      <h2 class="section-heading">Processing...</h2>
      <p class="lead muted" id="status">Checking your link...</p>
    </section>
  </section>

  <div class="gnostic-divider">
    <span class="divider-symbol pillar-glyph spin glow" aria-hidden="true">{{ glyph }}</span>
  </div>
</main>

<script type="module">
  import { getAuth } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
  import { app } from "/js/firebase-init.js";

  const auth = getAuth(app);
  const params = new URLSearchParams(window.location.search);
  const mode = params.get("mode");
  const oobCode = params.get("oobCode");
  const status = document.getElementById("status");

  // Basic validation
  if (!mode || !oobCode) {
    status.textContent = "The link is invalid or incomplete.";
  } else if (mode === "verifyEmail") {
    // Redirect to the verification handler
    window.location.href = `/verify-email/?${params.toString()}`;
  } else if (mode === "resetPassword") {
    // Redirect to the password reset handler
    window.location.href = `/reset-password/?${params.toString()}`;
  } else if (mode === "recoverEmail") {
    status.textContent = "Email recovery has not yet been implemented.";
  } else {
    status.textContent = "Unknown or unsupported action type.";
  }
</script>

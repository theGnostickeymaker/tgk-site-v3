---
layout: base.njk

# Identity
pageId: "logout"
permalink: "/logout/index.html"

# Unified Header Hierarchy
siteTitle: "The Gnostic Key"
pillarTitle: "Account"
gateTitle: null
seriesTitle: null
seasonTitle: null
episodeTitle: "Signing Out"
partTitle: null

# Display
title: "Signing Out"
description: "Ending your TGK session safely."
tagline: "Session closure and return to the Gate"

glyph: "⌁"
glyphRow: ["☉", "⌁", "☽"]
accent: "obsidian"
bodyClass: "obsidian"
tier: "free"

tags:
  - "account"
  - "logout"
  - "auth"

breadcrumbs:
  - { title: "The Gnostic Key", url: "/" }
  - { title: "Account" }
  - { title: "Signing Out" }
---

{% block head %}
  {% set socialImage = "/tgk-assets/images/share/system/logout.jpg" %}
  {% include "partials/head-meta.njk" %}
{% endblock %}

<main class="main-content center">
  <section class="content-container">
    <h2>Signing you out</h2>
    <p class="muted">Please wait while your session is securely closed.</p>
  </section>
</main>

<script type="module">
  import { app } from "/js/firebase-init.js";
  import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

  const auth = getAuth(app);

  (async () => {
    try {
      console.log("[TGK] Executing logout script");

      await signOut(auth);

      // Clear browser storage
      localStorage.clear();
      sessionStorage.clear();

      // Clear cookies
      document.cookie.split(";").forEach(c => {
        document.cookie = c
          .replace(/^ +/, "")
          .replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
      });

      console.log("[TGK] Sign-out complete. Redirecting home");
      window.location.href = "/";
    } catch (err) {
      console.error("[TGK] Logout failed:", err);
      window.location.href = "/";
    }
  })();
</script>

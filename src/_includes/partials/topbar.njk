{# ===========================================================
   ðŸœ‚ TGK â€” Unified Site Header (v3.0)
   Purpose:
   Renders the global header for all scrolls, vaults, and index pages.
   Combines breadcrumb navigation, glyph/title block, and mobile drawer.

   âœ… Expected Data:
     - title           â†’ Scroll / page title
     - tagline         â†’ Optional subtitle
     - breadcrumbs     â†’ Array of { title, url }
     - glyphRow        â†’ Array of glyphs for header cluster
     - pillarGlyph     â†’ Pillar-specific glyph
     - glyph           â†’ Fallback glyph (optional)
     - seriesMeta      â†’ { number, label } (optional)
     - episode         â†’ Numeric episode index
     - partNumeral     â†’ Roman or numeric string for part number
     - partTitle       â†’ Optional subtitle for part

   ðŸ§­ Behaviour:
     - Breadcrumbs auto-render with separators
     - Series chain builds dynamically if data exists
     - Hamburger button controls overlay + mobile nav panel
     - Keyboard / screen-reader safe (ARIA + tabindex handling)
   =========================================================== #}

<header class="site-header minimal" role="banner">
  {# --- Breadcrumb Navigation --- #}
  {% if breadcrumbs %}
  <nav class="breadcrumbs" aria-label="Breadcrumb">
    <span class="crumbs">
      {%- for bc in breadcrumbs -%}
        {%- if not loop.first %}<span class="sep"> | </span>{% endif -%}
        {%- if bc.url -%}
          <a href="{{ bc.url }}">{{ bc.title }}</a>
        {%- else -%}
          <span aria-current="page">{{ bc.title }}</span>
        {%- endif -%}
      {%- endfor -%}
    </span>
  </nav>
  {% endif %}

  {# --- Main Header Block --- #}
  <div class="header-main">
    {# Glyph logic: row, single pillar, or fallback #}
    {% if glyphRow %}
      <span class="pillar-glyph-row" aria-hidden="true">
        {% for g in glyphRow %}
          <span class="pillar-glyph">{{ g }}</span>
        {% endfor %}
      </span>
    {% elseif pillarGlyph or glyph %}
      <span class="pillar-glyph" aria-hidden="true">{{ pillarGlyph or glyph }}</span>
    {% endif %}

    {# --- Main Title --- #}
    <h1 class="page-title">{{ title }}</h1>

    {# --- Series / Episode / Part Chain --- #}
    {% if seriesMeta %}
      <h2 class="series-episode-chain">
        Series {{ seriesMeta.number | roman }}
        {% if episode %} Â· Episode {{ episode }}{% endif %}
        {% if partNumeral %}
          Â· Part {{ partNumeral }}
          {% if partTitle %}: {{ partTitle }}{% endif %}
        {% endif %}
      </h2>
    {% endif %}

    {# --- Dynamic Tagline --- #}
    {% if tagline %}
      <p class="page-tagline">{{ tagline }}</p>
    {% endif %}

    {# --- Publication Metadata --- #}
    {% if author or published %}
      <div class="scroll-meta header-inline">
        {% if author %}
          <span class="scroll-author">{{ author }}</span>
        {% endif %}
        {% if author and published %}
          <span class="meta-sep">â€¢</span>
        {% endif %}
        {% if published %}
          <span class="scroll-date">{{ published | tgkDate }}</span>
        {% endif %}
      </div>
    {% endif %}
  </div>
</header>

{# ===========================================================
   ðŸ“± Floating Hamburger + Drawer Navigation
   Accessible toggle pattern with overlay blocker.
   JS must sync [aria-expanded] + [hidden] states.
   =========================================================== #}

<!-- Floating Hamburger (top-left corner) -->
<div class="floating-hamburger">
  <button
    id="hamburgerFloating"
    class="drawer-toggle-floating"
    aria-controls="mobileNav"
    aria-expanded="false"
    aria-label="Open menu"
    type="button">â˜°</button>
</div>

<!-- Drawer Navigation Panel -->
<nav
  id="mobileNav"
  class="mobile-menu"
  hidden
  aria-hidden="true"
  aria-label="Mobile Navigation">
  <div class="drawer-content">

    <div class="drawer-label">Explore TGK</div>
    <ul class="nav-menu">
      <li><a href="/">Home</a></li>
      <li><a href="/pillars/the-teachings/">The Teachings</a></li>
      <li class="disabled"><span aria-disabled="true">Obsidian Key</span></li>
      <li><a href="/pillars/the-gnostic-eye/">Gnostic Eye</a></li>
      <li class="disabled"><span aria-disabled="true">Resonant</span></li>
      <li><a href="/pillars/the-vault/">Vault</a></li>
      <li class="disabled"><span aria-disabled="true">The Keymakerâ€™s Dream</span></li>
      <li class="disabled"><span aria-disabled="true">Childrenâ€™s Corner</span></li>
      <li class="disabled"><span aria-disabled="true">TGK Shop</span></li>
      <li class="disabled"><span aria-disabled="true">TGK Community</span></li>
    </ul>

    <div class="drawer-label">Membership</div>
    <ul class="nav-menu">
      <li data-auth="false"><a href="/signin/">Sign In</a></li>
      <li data-auth="false"><a href="/signup/">Create Account</a></li>
      <li data-auth="true"><a href="/dashboard/">Dashboard</a></li>
      <li data-auth="true"><a href="/account/">Account</a></li>
      <li data-auth="true"><a href="/bookmarks/">Bookmarks</a></li>
      <li data-auth="true"><a href="/logout/">Sign Out</a></li>
    </ul>

    <div class="drawer-label">Connect</div>
    <ul class="social-nav">
      <li><a href="https://facebook.com/thegnostickey"  target="_blank" rel="noopener noreferrer">Facebook</a></li>
      <li><a href="https://instagram.com/thegnostickey" target="_blank" rel="noopener noreferrer">Instagram</a></li>
      <li><a href="https://tiktok.com/@thegnostickey"   target="_blank" rel="noopener noreferrer">TikTok</a></li>
      <li><a href="https://youtube.com/@thegnostickey"  target="_blank" rel="noopener noreferrer">YouTube</a></li>
      <li><a href="https://twitter.com/thegnostickey"   target="_blank" rel="noopener noreferrer">X</a></li>
      <li><a href="https://t.me/thegnostickey"          target="_blank" rel="noopener noreferrer">Telegram</a></li>
      <li><a href="https://thegnostickey.substack.com"  target="_blank" rel="noopener noreferrer">Substack</a></li>
    </ul>
  </div>
</nav>

<!-- Overlay (click to close drawer) -->
<div id="navOverlay" class="nav-overlay" hidden></div>

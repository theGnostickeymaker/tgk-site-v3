{# =======================================================
   üß† TGK ‚Äî Quiz Data Loader (v2.1)
   Purpose:
   Injects quiz JSON into a <script> tag for the client-side
   quiz-engine.js to locate and render dynamically.

   ‚úÖ Expects:
   - quizId ‚Üí string (matches /src/_data/quiz/[quizId].js)
   - quiz   ‚Üí optional global data object (legacy)
   
   ‚öôÔ∏è Behaviour:
   - If the Eleventy data cascade already includes quiz[quizId],
     it embeds that data as inline JSON.
   - Otherwise, the JS loader will fetch it dynamically at runtime.
   ======================================================= #}

{% if quizId %}
  {# --- Try Eleventy global data first (for build-time availability) --- #}
  {% set quizData = quiz and quiz[quizId] %}
  {% if quizData %}
    <script 
      type="application/json" 
      id="quiz-data-{{ quizId }}" 
      class="quiz-data">
      {{ quizData | dump | safe }}
    </script>
    <script>
      console.log("[TGK QUIZ] ‚úÖ Inline data injected for quizId: {{ quizId }}");
    </script>
  {% else %}
    {# --- Fallback: runtime fetch handled by quiz-engine.js --- #}
    <script>
      console.log("[TGK QUIZ] ‚öôÔ∏è Deferred load: will fetch /_data/quiz/{{ quizId }}.js");
    </script>
  {% endif %}
{% else %}
  <script>console.warn("[TGK QUIZ] ‚ö†Ô∏è No quizId passed to loader");</script>
{% endif %}

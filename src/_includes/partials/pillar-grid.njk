{# =========================================================
   🜂 TGK — Pillar / Series Grid Partial (v3.0)
   Purpose:
   Renders a responsive card grid for collections such as:
   • Pillar landing pages
   • Series selection pages
   • Episode or Vault collections

   ✅ Expects:
   - pillarGrid = [
       {
         href, title, glyph, desc/tagline,
         tier (free/initiate/full),
         state (default, coming-soon, premium, locked, archived, draft),
         image (optional thumbnail),
         badge (optional override)
       }
     ]

   🧭 Behaviour:
   • Automatically applies classes and overlays per state
   • Shows a glyph and title prominently
   • Adds tier badge (“Free”, “Initiate”, “Full Access”)
   • Clean fallback handling for missing fields

   ✨ State Guide:
   default      → normal card
   coming-soon  → greyed banner
   premium      → golden glow
   locked       → semi-transparent lock overlay
   archived     → faded aesthetic
   draft        → soft gradient + “In Development” label

   ⚙️ Notes:
   • Fully responsive (uses .portal-grid layout container)
   • Accessible — non-decorative text always wrapped in <p>/<h3>
   • Safe for reuse on Vault, Teachings, Obsidian Key, etc.
   ========================================================= #}

{%- if pillarGrid and pillarGrid.length -%}
<section class="pillar-grid">
  <div class="portal-grid">
    {% for c in pillarGrid %}
      {# --- Derive state + CSS class --- #}
      {% set state = c.state or c.status or "default" %}
      {% set cls = "gnostic-card" %}
      {% if state == "premium" %}
        {% set cls = cls + " premium" %}
      {% elif state == "coming-soon" %}
        {% set cls = cls + " coming-soon" %}
      {% elif state == "locked" %}
        {% set cls = cls + " locked" %}
      {% elif state == "archived" %}
        {% set cls = cls + " archived" %}
      {% elif state == "draft" %}
        {% set cls = cls + " draft" %}
      {% endif %}

      <article class="{{ cls }}">
        <a class="card-link" href="{{ c.href or c.url or '#' }}">

          {# --- Optional thumbnail image --- #}
          {% if c.image %}
            <figure class="card-media">
              <img src="{{ c.image }}" alt="{{ c.title or 'Card Image' }}" loading="lazy">
            </figure>
          {% endif %}

          <div class="card-body">
            {% if c.glyph %}
              <div class="card-glyph" aria-hidden="true">{{ c.glyph }}</div>
            {% endif %}

            <h3 class="card-title">{{ c.title or "Untitled" }}</h3>

            {# --- Optional tagline / description --- #}
            {% if (c.desc and c.desc != state) or (c.tagline and c.tagline != state) %}
              <p class="card-desc">{{ c.desc or c.tagline }}</p>
            {% endif %}
          </div>

          {# --- Overlay banners for card state --- #}
          {% if state == "coming-soon" %}
            <div class="card-overlay"><span class="banner">Coming Soon</span></div>
          {% elif state == "premium" %}
            <div class="card-overlay"><span class="banner">Premium</span></div>
          {% elif state == "locked" %}
            <div class="card-overlay"><span class="banner">Locked</span></div>
          {% elif state == "archived" %}
            <div class="card-overlay"><span class="banner">Archived</span></div>
          {% elif state == "draft" %}
            <div class="card-overlay"><span class="banner">In Development</span></div>
          {% endif %}

          {# --- Tier badge logic --- #}
          {% set badgeTxt = c.badge %}
          {% if not badgeTxt %}
            {% if c.tier == "full" %}
              {% set badgeTxt = "Full Access" %}
            {% elif c.tier == "initiate" %}
              {% set badgeTxt = "Initiate" %}
            {% elif c.tier == "adept" %}
              {% set badgeTxt = "Adept" %}
            {% elif c.tier == "initiate-trial" %}
              {% set badgeTxt = "Free Intro" %}
            {% elif c.tier == "free" %}
              {% set badgeTxt = "Free" %}
            {% endif %}
          {% endif %}
          {% if badgeTxt %}
            <div class="card-badge tier-{{ c.tier | default('none') }}">{{ badgeTxt }}</div>
          {% endif %}
        </a>
      </article>
    {% endfor %}
  </div>
</section>
{%- endif -%}
